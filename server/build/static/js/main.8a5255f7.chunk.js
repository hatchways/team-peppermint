(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{248:function(e,t,n){},251:function(e,t,n){},413:function(e,t,n){"use strict";n.r(t);var a=n(0),c=n(14),r=n.n(c),i=(n(248),n(110)),o=n(18),s=n(226),l=Object(s.a)({typography:{fontFamily:'"Poppins", sans-serif',fontSize:16,h1:{},caption:{}},palette:{primary:{main:"#3A8DFF"}}}),u=n(474),d=n(475),j=n(476),b=(n(251),n(9)),g=n(69),h=n(13),f={SET_CONVERSATIONS:"SET_CONVERSATIONS",SET_MESSAGES:"SET_MESSAGES",SET_CURRENT_CONVERSATION:"SET_CURRENT_CONVERSATION",PUSH_MESSAGE:"PUSH_MESSAGE",SET_SOCKET:"SET_SOCKET",UPDATE_USER_IMAGE:"UPDATE_USER_IMAGE",SET_USER_DATA:"SET_USER_DATA",SET_CONTACTS:"RESET_LISTS",FETCH_CONVERSATIONS:"FETCH_CONVERSATIONS",UPDATE_CONVERSATIONS:"UPDATE_CONVERSATIONS",ADD_CONVERSATION:"RESET_CONVERSATIONS",ADD_CONTACT:"ADD_CONTACT"},O=function(e,t){return{type:e,payload:t}},m=function(e,t){switch(t.type){case f.SET_USER_DATA:return Object(b.a)(Object(b.a)({},e),t.payload);case f.UPDATE_USER_IMAGE:return Object(b.a)(Object(b.a)({},e),{},{user:Object(b.a)(Object(b.a)({},e.user),{},{pictureURL:{url:t.payload.imageUrl}})});case f.SET_SOCKET:return Object(b.a)(Object(b.a)({},e),{},{socket:t.payload});default:return e}},p=n(34),x=n.n(p),v={"Content-Type":"application/json"},y={login:function(e){return x()("/api/user/login",{method:"POST",data:e,headers:v})},register:function(e){return x()("/api/user/",{method:"POST",data:e,headers:v})},logout:function(){return x.a.get("/api/user/logout")},isAuthenticated:function(){return x.a.get("/api/user/authenticated").then((function(e){return 401!==e.status?e:{isAuthenticated:!1,user:{email:"",name:"",role:""}}}))},getUserConversations:function(){return x.a.get("/api/user/conversations")},getUserContacts:function(){return x.a.get("/api/user/contacts")},searchUsersByEmailOrName:function(e){return x.a.get("/api/user?searchTerm=".concat(e))},addContact:function(e){return x()("/api/user/contacts",{method:"POST",data:{contactID:e},headers:v})}},S=n(198),C=n.n(S),w=n(2),E=Object(a.createContext)(),T=Object(a.createContext)(),N={isAuthenticated:!1,isLoaded:!1,user:{_id:"",name:"",email:"",language:"",pictureURL:{url:""}},socket:null},_=function(e){var t=e.children,n=Object(a.useReducer)(m,N),c=Object(h.a)(n,2),r=c[0],i=c[1];return Object(a.useEffect)((function(){y.isAuthenticated().then((function(e){i(O(f.SET_USER_DATA,e.data))})).catch((function(e){return console.error(e.message)}))}),[]),Object(a.useEffect)((function(){return r.isAuthenticated&&!r.socket&&i(O(f.SET_SOCKET,C()({query:{userID:r.user._id}}))),function(){var e;return null===(e=r.socket)||void 0===e?void 0:e.disconnect}}),[r]),Object(w.jsxs)(E.Provider,{value:r,children:[Object(w.jsx)(T.Provider,{value:i,children:t})," "]})},A=function(){return Object(a.useContext)(E)},R=function(e){var t=e.component,n=(e.roles,Object(g.a)(e,["component","roles"])),a=A().isAuthenticated;return Object(w.jsx)(o.b,Object(b.a)(Object(b.a)({},n),{},{render:function(e){return a?Object(w.jsx)(t,Object(b.a)({},e)):Object(w.jsx)(o.a,{to:{pathname:"/",state:{from:e.location}}})}}))},k=function(e){var t=e.component,n=Object(g.a)(e,["component"]),a=A().isAuthenticated;return Object(w.jsx)(o.b,Object(b.a)(Object(b.a)({},n),{},{render:function(e){return a?Object(w.jsx)(o.a,{to:{pathname:"/home",state:{from:e.location}}}):Object(w.jsx)(t,Object(b.a)({},e))}}))},I=n(466),D=n(25),P=n(456),U=n.p+"static/media/login-signup-bgImage.0c5628a9.png",F=n(200),L=n.n(F),M=n(201),B=n.n(M),V=Object(P.a)(Object(D.a)({imageContainer:{backgroundImage:"url(".concat(U,")"),backgroundRepeat:"no-repeat",backgroundSize:"cover",height:"100vh",width:"40vw",marginRight:20},gradientContainer:{backgroundImage:"linear-gradient(#3a8cffca, #86b8ffc9)",height:"100vh",width:"40vw",display:"grid",justifyItems:"center",alignItems:"center"},iconStyle:{fontSize:70,color:"rgba(255, 255, 255, 0.80)"},textStyle:{color:"rgba(255, 255, 255, 0.95)",fontWeight:"200",fontSize:40,width:"70%",textAlign:"center",marginBottom:-80,marginTop:-80}},"@media (max-width:560px)",{imageContainer:{height:"20vh",width:"100vw"},gradientContainer:{height:"20vh",width:"100vw"},textStyle:{fontSize:25}}));function H(){var e=V();return Object(w.jsx)("div",{className:e.imageContainer,children:Object(w.jsxs)("div",{className:e.gradientContainer,children:[Object(w.jsx)(L.a,{className:e.iconStyle}),Object(w.jsx)("h3",{className:e.textStyle,children:"Converse with anyone with any language"}),Object(w.jsx)(B.a,{className:e.iconStyle})]})})}var W=n(416),z=n(479),G=n(464),q=n(20),K=Object(P.a)((function(e){return{root:{background:"#FFFFFF",width:"100%",height:"100%",display:"flex",alignItems:"center"},form:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},formField:{width:"70%",margin:e.spacing(1,0)},submitButton:{width:"50%",borderRadius:0}}})),Q=function(e){var t=e.renderRegister,n=Object(a.useContext)(T),c=Object(a.useState)(null),r=Object(h.a)(c,2),i=r[0],o=r[1],s=K();return Object(w.jsxs)("div",{className:s.root,children:[Object(w.jsx)(q.c,{initialValues:{email:"",password:""},onSubmit:function(e){y.login(e).then((function(e){n(O(f.SET_USER_DATA,e.data))})).catch((function(e){return o(e)}))},children:function(e){e.values;return Object(w.jsxs)(q.b,{className:s.form,children:[Object(w.jsx)(W.a,{variant:"h3",children:"Login"}),Object(w.jsx)(q.a,{className:s.formField,name:"email",type:"email",label:"Email",variant:"outlined",as:z.a}),Object(w.jsx)(q.a,{className:s.formField,name:"password",type:"password",label:"Password",variant:"outlined",as:z.a}),Object(w.jsx)(G.a,{children:"Forgot Password?"}),Object(w.jsx)(G.a,{className:s.submitButton,type:"submit",variant:"contained",color:"primary",children:Object(w.jsx)(W.a,{variant:"h5",children:"Login"})}),Object(w.jsx)(G.a,{onClick:t,children:"Create Account"})]})}}),i&&Object(w.jsxs)("div",{children:[" ",i]})]})},$=n(480),J=n(465),X=n(71),Y=X.a().shape({name:X.c().max(50,"Too Long").required("Required"),email:X.c().email("Invalid Email").required("Required"),password:X.c().min(8,"Password is too short, should be at least 8 characters").required("Required"),confirmPassword:X.c().oneOf([X.b("password"),null],"Passwords must match"),language:X.c().required("Required")}),Z={name:"",email:"",password:"",confirmPassword:"",language:"english"},ee=function(e){var t=e.history,n=e.renderLogin,c=A(),r=Object(a.useState)(null),i=Object(h.a)(r,2),o=i[0],s=i[1],l=K();return Object(a.useEffect)((function(){console.log(c)}),[c]),Object(w.jsxs)("div",{className:l.root,children:[Object(w.jsx)(q.c,{initialValues:Z,onSubmit:function(e){y.register(e).then((function(e){console.log(e),"error"!==e.status?t.push("/home"):s(e.message)})).catch((function(e){return console.log(e)}))},validationSchema:Y,children:function(e){var t=e.errors,a=e.touched;return Object(w.jsxs)(q.b,{className:l.form,children:[Object(w.jsx)(W.a,{variant:"h3",children:"Sign Up"}),Object(w.jsx)(q.a,{className:l.formField,name:"email",type:"email",label:"Email",variant:"outlined",error:t.email&&a.email,helperText:t.email,as:z.a}),Object(w.jsx)(q.a,{className:l.formField,name:"name",type:"text",label:"Name",variant:"outlined",error:t.name&&a.name,helperText:t.name,as:z.a}),Object(w.jsx)(q.a,{className:l.formField,name:"password",type:"password",label:"Password",variant:"outlined",error:t.password&&a.password,helperText:t.password,as:z.a}),Object(w.jsx)(q.a,{className:l.formField,name:"confirmPassword",type:"password",label:"Confirm Password",variant:"outlined",error:t.confirmPassword&&a.confirmPassword,helperText:t.confirmPassword,as:z.a}),Object(w.jsxs)(q.a,{className:l.formField,name:"language",label:"Language",variant:"outlined",as:$.a,children:[Object(w.jsx)(J.a,{value:"english",children:"English"}),Object(w.jsx)(J.a,{value:"french",children:"French"}),Object(w.jsx)(J.a,{value:"chinese",children:"Chinese"}),Object(w.jsx)(J.a,{value:"russian",children:"Russian"})]}),Object(w.jsx)(G.a,{className:l.submitButton,type:"submit",variant:"contained",color:"primary",children:Object(w.jsx)(W.a,{variant:"h5",children:"Sign Up"})}),Object(w.jsx)(G.a,{onClick:n,children:"Sign In"})]})}}),o&&Object(w.jsxs)("div",{children:[" ",o]})]})},te=function(e){var t=e.history,n=Object(a.useState)(!0),c=Object(h.a)(n,2),r=c[0],i=c[1];return Object(w.jsxs)(I.a,{container:!0,justify:"center",alignItems:"stretch",children:[Object(w.jsx)(I.a,{item:!0,xs:6,children:Object(w.jsx)(H,{})}),Object(w.jsx)(I.a,{item:!0,xs:6,children:r?Object(w.jsx)(Q,{history:t,renderRegister:function(){return i(!1)}}):Object(w.jsx)(ee,{history:t,renderLogin:function(){return i(!0)}})})]})},ne=Object(P.a)((function(e){return{root:{display:"flex",flexDirection:"column",alignItems:"center",width:"35%",height:"100%",backgroundColor:"#f5f7fb"}}})),ae=n(43),ce=n.n(ae),re=n(68),ie=n(484),oe=n(122),se=n(227),le=Object(P.a)((function(e){return Object(D.a)({root:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",minHeight:"10vh",backgroundColor:"transparent"},leftRightSideStyle:{display:"flex",justifyContent:"center",alignItems:"center",padding:e.spacing(2)},badge:{top:63,right:5},typography:{fontWeight:600,textAlign:"center"},logoutStyle:{color:"black",textDecoration:"none"}},"@media (max-width:400px)",{root:{padding:e.spacing(2)},leftRightSideStyle:{flexDirection:"column",height:"10vh",padding:0},typography:{fontSize:"1.3rem"}})})),ue=n(225),de=n(469),je=n(483),be=n.p+"static/media/avatar.c2a95cb3.png",ge=n(468),he=n(6),fe=(Object(he.a)((function(e){return{badge:{backgroundColor:"#D3D3D3",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),width:e.spacing(1.4),height:e.spacing(1.4),borderRadius:"50%",top:e.spacing(5),right:e.spacing(.5)}}}))(ge.a),Object(he.a)((function(e){return{badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),width:e.spacing(1.1),height:e.spacing(1.1),borderRadius:"50%",top:e.spacing(5),right:e.spacing(.5),"&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(ge.a),Object(P.a)((function(e){return Object(D.a)({root:{display:"flex","& > *":{margin:e.spacing(1),marginRight:e.spacing(3)}},avatar:{width:e.spacing(6.5),height:e.spacing(6.5)}},"@media (max-width:400px)",{root:{"& > *":{marginRight:e.spacing(1)}}})}))),Oe=Object(P.a)((function(e){return{badge:function(t){return{backgroundColor:t.isOnline?"#44b700":"#D3D3D3",boxShadow:"0 0 0 2px #FFF",height:e.spacing(1.2),width:e.spacing(1.2),borderRadius:"50%",marginBottom:e.spacing(1),marginRight:e.spacing(1)}}}})),me=function(e){var t=e.children,n=e.isOnline,a=Oe({isOnline:n});return Object(w.jsx)(ge.a,{classes:{badge:a.badge},badgeContent:"",variant:"dot",anchorOrigin:{vertical:"bottom",horizontal:"right"},children:t})},pe=function(e){var t=e.imageUrl,n=e.isOnline,a=fe({isOnline:n}),c="";return c=void 0!==t&&void 0!==t.url&&t.url.includes("http")?t.url:be,Object(w.jsx)("div",{className:a.root,children:Object(w.jsx)(me,{isOnline:n,children:Object(w.jsx)(je.a,{variant:"circular",alt:"Badge",src:c,className:a.avatar})})})},xe=function(){var e=Object(a.useState)(!1),t=Object(h.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(null),i=Object(h.a)(r,2),o=i[0],s=i[1],l=A().user,u=le(),d=function(){s(null)},j=function(){var e=Object(re.a)(ce.a.mark((function e(t){return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(w.jsxs)("div",{className:u.root,children:[Object(w.jsxs)("div",{className:u.leftRightSideStyle,children:[Object(w.jsx)(pe,{imageUrl:l.pictureURL}),Object(w.jsx)(W.a,{variant:"body2",className:u.typography,children:l.name})]}),Object(w.jsxs)("div",{className:u.leftRightSideStyle,children:[Object(w.jsx)(ie.a,{title:"More actions",placement:"bottom",arrow:!0,children:Object(w.jsx)(oe.a,{"aria-controls":"simple-menu","aria-haspopup":"true",onClick:function(e){s(e.currentTarget)},style:{marginLeft:20},children:Object(w.jsx)(de.a,{})})}),Object(w.jsxs)(se.a,{id:"simple-menu",anchorEl:o,keepMounted:!0,open:Boolean(o),onClose:d,children:[Object(w.jsx)(J.a,{onClick:function(){return c(!0)},children:"Replace picture"}),Object(w.jsx)(J.a,{onClick:function(){y.logout().then((function(e){return console.log(e)})).catch((function(e){return console.error(e)}))},children:"Log out"})]}),Object(w.jsx)(ue.a,{open:n,onSave:j,showPreviews:!0,maxFileSize:2e6,onClose:function(){c(!1),d()}})]})]})},ve=Object(P.a)((function(e){return Object(D.a)({root:{display:"flex",flexDirection:"column",alignItems:"center",flexGrow:1,width:"100%",height:"100%",backgroundColor:"transparent",overflow:"hidden"},tabs:{backgroundColor:"#f5f7fb",borderColor:"none"},tabPanel:{width:"100%",height:"100%"},search:Object(D.a)({display:"flex",justifyContent:"center",borderRadius:e.shape.borderRadius,backgroundColor:"#e9eef9",marginTop:e.spacing(2),marginBottom:e.spacing(2),minWidth:"100%",height:e.spacing(7)},e.breakpoints.up("sm"),{width:"auto"}),searchIcon:{padding:e.spacing(0,2),height:"100%",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},clearIcon:{padding:e.spacing(0,2),height:"100%",display:"flex",alignItems:"center",justifyContent:"center"},debounceInput:{border:"none",height:"100%",width:"70%",backgroundColor:"transparent",fontSize:"1.3rem",right:0,outline:"none"},collapse:{textAlign:"center",marginBottom:e.spacing(1),width:"100%"},alert:{display:"flex",alignItems:"center",justifyContent:"center"}},"@media (max-width:400px)",{tabs:{display:"flex",alignItems:"center",justifyContent:"center"}})})),ye=n(477),Se=n(471),Ce=n(478),we=n(472),Ee=Object(P.a)((function(e){return{root:{padding:0,maxHeight:"65vh",flexGrow:1,overflow:"auto",backgroundColor:"transparent","-ms-overflow-style":"none","scrollbar-width":"none","&::-webkit-scrollbar":{display:"none"}}}})),Te=Object(P.a)((function(e){return Object(D.a)({root:{display:"flex",alignItems:"center",padding:e.spacing(2),marginBottom:e.spacing(1),width:"100%",backgroundColor:"#f9fafc",boxShadow:"0 0 1px 0 grey"},avatarNameContainer:{display:"flex",alignItems:"center",width:"75%",height:"100%"},nameContainer:{display:"flex",flexDirection:"column",alignContent:"center",justifyContent:"center"},chip:{display:"block",marginLeft:e.spacing(1),marginRight:e.spacing(1)}},"@media (max-width:360px)",{avatarNameContainer:{flexDirection:"column",justifyContent:"center"}})})),Ne=n(418),_e=Object(a.createContext)(),Ae=function(e,t,n){return e?t?Object.values(e.textVersions)[0]:e.textVersions[n]||Object.values(e.textVersions)[0]:""},Re=function(){return Object(a.useContext)(_e)},ke=function(e){var t=e.children,n=Object(a.useState)(!1),c=Object(h.a)(n,2),r=c[0],i=c[1],o=Object(a.useCallback)((function(){i(!r)}),[r]);return Object(w.jsx)(_e.Provider,{value:{isOriginalLanguage:r,toggleOrginalLanguage:o},children:t})},Ie={"Content-Type":"application/json"},De={sendMessage:function(e,t){return x()("/api/conversations/".concat(e,"/message"),{method:"POST",data:t,headers:Ie})},fetchConversationById:function(e){return x.a.get("/api/conversations/".concat(e))}},Pe=n(29),Ue=function(e,t){switch(t.type){case f.SET_CURRENT_CONVERSATION:return Object(b.a)(Object(b.a)({},e),t.payload);case f.SET_MESSAGES:return Object(b.a)(Object(b.a)({},e),{},{messages:t.payload});case f.PUSH_MESSAGE:return Object(b.a)(Object(b.a)({},e),{},{messages:[].concat(Object(Pe.a)(e.messages),[t.payload])});default:return e}},Fe=Object(a.createContext)(),Le=Object(a.createContext)(),Me={_id:"",conversationID:"",conversationTitle:"",users:"",messages:[],lastMessage:""},Be=function(){return Object(a.useContext)(Fe)},Ve=function(){return Object(a.useContext)(Le)},He=function(e){var t=e.children,n=Object(a.useReducer)(Ue,Me),c=Object(h.a)(n,2),r=c[0],i=c[1];return Object(a.useEffect)((function(){""!==r._id&&De.fetchConversationById(r._id).then((function(e){i(O(f.SET_MESSAGES,e.data.conversation.messages))})).catch((function(e){return console.log(e)}))}),[r._id]),Object(w.jsx)(Fe.Provider,{value:r,children:Object(w.jsx)(Le.Provider,{value:i,children:t})})},We=function(e){var t=e.conversation,n=(e.index,e.selected,Te()),c=A(),r=c.user,i=c.socket,o=t._id,s=t.users,l=t.conversationTitle,u=t.lastMessage,d=Re().isOriginalLanguage,j=Object(a.useState)(u),b=Object(h.a)(j,2),g=b[0],m=b[1],p=Be(),x=Ve(),v=s.length>2,y=s.filter((function(e){return e._id!==r._id})),S=v?l||"Group Chat":y[0].name;return Object(a.useEffect)((function(){return i.on("".concat(t._id,"-message"),(function(e){m(e),p._id===o&&x(O(f.PUSH_MESSAGE,e))})),function(){return i.off("".concat(t._id,"-message"))}}),[]),Object(w.jsx)(Ne.a,{button:!0,className:n.root,onClick:function(){x(O(f.SET_CURRENT_CONVERSATION,t))},selected:(null===p||void 0===p?void 0:p._id)===o,children:Object(w.jsxs)("div",{className:n.avatarNameContainer,children:[1===s.length&&Object(w.jsx)(pe,{imageUrl:""}),Object(w.jsxs)("div",{className:n.nameContainer,children:[Object(w.jsx)(W.a,{variant:"body1",gutterBottom:!0,children:S}),Object(w.jsx)(W.a,{variant:"body2",gutterBottom:!0,children:Ae(g,d,r.language)})]})]})})},ze=n(463),Ge=function(e,t){switch(t.type){case f.SET_CONVERSATIONS:case f.ADD_CONVERSATION:return Object(b.a)(Object(b.a)({},e),{},{conversations:t.payload});default:return e}},qe=Object(a.createContext)(),Ke=Object(a.createContext)(),Qe={conversations:[]},$e=function(){return Object(a.useContext)(qe)},Je=function(e){var t=e.children,n=Object(a.useReducer)(Ge,Qe),c=Object(h.a)(n,2),r=c[0],i=c[1],o=A().isAuthenticated;return Object(a.useEffect)((function(){o&&y.getUserConversations().then((function(e){i(O(f.SET_CONVERSATIONS,e.data.conversations))})).catch((function(e){return console.log(e)}))}),[o]),Object(w.jsx)(qe.Provider,{value:r,children:Object(w.jsx)(Ke.Provider,{value:i,children:t})})},Xe=function(){var e=Ee(),t=$e().conversations;return Object(w.jsx)(ze.a,{className:e.root,children:t.length>0?t.map((function(e,t){return Object(w.jsx)(We,{conversation:e,index:t},t)})):Object(w.jsx)(W.a,{variant:"body1",color:"primary",gutterBottom:!0,style:{color:"black",textAlign:"center"},children:"No group chats"})})},Ye=Object(P.a)((function(e){return{root:{padding:0},buttonsContainer:{display:"flex",flexDirection:"column"}}})),Ze=n(470),et=Object(P.a)((function(e){return Object(D.a)({root:{display:"flex",alignItems:"center",width:"100%"},contactButton:{width:"100%",justifyContent:"start","&:focus":{outline:"none"}},avatarNameContainer:{display:"flex",alignItems:"center",width:"50%",height:"100%"},chip:{marginLeft:e.spacing(1),marginRight:e.spacing(1)},buttonBase:{marginLeft:20,marginRight:20,padding:10,borderRadius:"50%"},contactName:{marginBottom:0,fontWeight:600}},"@media (max-width:400px)",{avatarNameContainer:{flexDirection:"column",justifyContent:"center"},contactName:{fontSize:"1.3rem"}})})),tt=n(217),nt=n.n(tt),at=n(467),ct=n(218),rt=n.n(ct),it=function(e,t){switch(t.type){case f.SET_CONTACTS:return Object(b.a)(Object(b.a)({},e),{},{contacts:t.payload});case f.ADD_CONTACT:return Object(b.a)(Object(b.a)({},e),{},{contacts:[].concat(Object(Pe.a)(e.contacts),[t.payload])});case f.UPDATE_CONTACT_STATUS:var n=e.contacts.indexOf(t.payload.contact);return e.contacts[n].isOnline=t.payload.status,Object(b.a)({},e);default:return e}},ot=Object(a.createContext)(),st=Object(a.createContext)(),lt={contacts:[]},ut=function(e){var t=e.children,n=Object(a.useReducer)(it,lt),c=Object(h.a)(n,2),r=c[0],i=c[1],o=A().isAuthenticated;return Object(a.useEffect)((function(){o&&y.getUserContacts().then((function(e){return i(O(f.SET_CONTACTS,e.data.contacts))})).catch((function(e){return console.error(e)}))}),[o]),Object(w.jsx)(ot.Provider,{value:r,children:Object(w.jsx)(st.Provider,{value:i,children:t})})},dt=function(e){var t=e.contact,n=e.unknown,c=e.removeFromUknown,r=et(),i=$e().conversations,o=A(),s=o.user,l=o.socket,u=t.name,d=t.isOnline,j=Object(a.useContext)(st),b=Object(a.useContext)(Ke),g=Be(),h=Ve(),m=nt()([s._id,t._id].sort().join());return Object(a.useEffect)((function(){var e=function(e){j(O(f.UPDATE_CONTACT_STATUS,{contact:t,status:e}))};return l.on("".concat(t._id,"-login"),(function(t){var a=t.isOnline;n||e(a)})),l.on("".concat(t._id,"-logout"),(function(t){var a=t.isOnline;n||e(a)})),function(){l.off("".concat(t._id,"-login")),l.off("".concat(t._id,"-logout "))}}),[l,n,t,j]),Object(w.jsxs)(Ne.a,{className:r.root,selected:g.conversationID===m&&null===g.conversationTitle,children:[Object(w.jsxs)(oe.a,{className:r.contactButton,disabled:n,onClick:function(){var e=i.find((function(e){return e.conversationID===m&&null===e.conversationTitle}));h(O(f.SET_CURRENT_CONVERSATION,e))},children:[Object(w.jsx)(pe,{isOnline:d}),Object(w.jsx)(W.a,{variant:"h6",children:u})]}),n&&Object(w.jsx)(at.a,{onClick:function(){y.addContact(t._id).then((function(e){j(O(f.ADD_CONTACT,e.data.newContact)),e.data.newConversation&&b(O(f.ADD_CONVERSATION,e.data.newConversation)),c(t)})).catch((function(e){return console.log(e)}))},children:Object(w.jsx)(rt.a,{color:"primary"})})]})},jt=n(230),bt=n(220),gt=n.n(bt),ht=n(219),ft=n.n(ht),Ot=Object(P.a)((function(e){return{root:{display:"flex",width:"90%",margin:"auto",padding:e.spacing(1,2),alignItems:"center",justifyContent:"space-between"},searchBar:{display:"flex",flexDirection:"row"},toggleButton:{height:"90%",padding:e.spacing(0,1),margin:"auto"},toggleButtonSelected:{color:e.palette.success.main}}})),mt=function(e){var t,n=e.contacts,c=e.updateContactList,r=e.updateUnknownList,i=Ot(),o=Object(a.useState)(!0),s=Object(h.a)(o,2),l=s[0],u=s[1],d=function(e){if(l)y.searchUsersByEmailOrName(e.toLowerCase()).then((function(e){return r(e.data.users)})).catch((function(e){return console.log(e)}));else{var t=n.filter((function(t){return t.name.toLowerCase().startsWith(e.toLowerCase())||t.email.toLowerCase().startsWith(e.toLowerCase())}));c(t)}};return Object(w.jsxs)("div",{className:i.root,children:[Object(w.jsx)(at.a,{onClick:function(){return u(!l)},children:Object(w.jsx)(ft.a,{color:l?"primary":"disabled"})}),Object(w.jsx)(q.c,{initialValues:{searchQuery:""},onSubmit:d,children:function(e){e.values;var a=e.setFieldValue;return Object(w.jsx)(q.b,{className:i.searchBar,children:Object(w.jsx)(q.a,{className:i.seachTextField,name:"searchQuery",type:"text",placeholder:"Search Contact",as:jt.a,onChange:function(e){return function(e,a){a("searchQuery",e),t&&clearTimeout(t),e.length>=3&&(t=setTimeout((function(){return d(e)}),700)),""===e&&(c(n),r([]))}(e.target.value,a)},endAdornment:Object(w.jsx)(gt.a,{color:"disabled"})})})}})]})},pt=function(){var e=Ye(),t=Object(a.useContext)(ot).contacts,n=Object(a.useState)(t),c=Object(h.a)(n,2),r=c[0],i=c[1],o=Object(a.useState)([]),s=Object(h.a)(o,2),l=s[0],u=s[1],d=function(e){u((function(t){var n=t;return n.splice(t.indexOf(e)),n}))};return Object(a.useEffect)((function(){console.log(l)}),[l]),Object(a.useEffect)((function(){i(t)}),[t]),Object(w.jsxs)("div",{className:e.root,children:[Object(w.jsx)(mt,{contacts:t,updateContactList:i,updateUnknownList:u}),l.map((function(e,t){return Object(w.jsx)(dt,{contact:e,unknown:!0,removeFromUknown:d},t)})),Object(w.jsx)(Ze.a,{variant:"middle"}),r.map((function(e,t){return Object(w.jsx)(dt,{contact:e},t)}))]})};function xt(e){var t=e.children,n=e.value,a=e.index,c=Object(g.a)(e,["children","value","index"]);return Object(w.jsx)("div",Object(b.a)(Object(b.a)({role:"tabpanel",hidden:n!==a,id:"simple-tabpanel-".concat(a),"aria-labelledby":"simple-tab-".concat(a)},c),{},{children:n===a&&Object(w.jsx)(ye.a,{children:t})}))}function vt(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}var yt=function(){var e=ve(),t=Object(a.useState)(0),n=Object(h.a)(t,2),c=n[0],r=n[1];return Object(w.jsxs)("div",{className:e.root,children:[Object(w.jsx)(Se.a,{position:"static",style:{color:"black",maxWidth:"100%",backgroundColor:"#f5f7fb",boxShadow:"none"},children:Object(w.jsxs)(Ce.a,{value:c,onChange:function(e,t){r(t)},"aria-label":"simple tabs example",variant:"fullWidth",children:[Object(w.jsx)(we.a,Object(b.a)(Object(b.a)({label:"Chats"},vt(0)),{},{style:{minWidth:"50%",outline:"none"}})),Object(w.jsx)(we.a,Object(b.a)(Object(b.a)({label:"Contacts"},vt(1)),{},{style:{minWidth:"50%",outline:"none"}}))]})}),Object(w.jsx)(xt,{value:c,index:0,className:e.tabPanel,children:Object(w.jsx)(Xe,{})}),Object(w.jsx)(xt,{value:c,index:1,className:e.tabPanel,children:Object(w.jsx)(pt,{})})]})},St=function(){var e=ne();return Object(w.jsxs)("div",{className:e.root,children:[Object(w.jsx)(xe,{}),Object(w.jsx)(yt,{})]})},Ct=Object(P.a)((function(e){return{root:{width:"100%",padding:e.spacing(2),display:"flex",justifyContent:function(e){return e.isMyMessage?"flex-end":"flex-start"}},messageContianer:{minWidth:"12ch"},messageBox:{width:"100%",display:"flex",padding:10,borderRadius:10,borderBottomRightRadius:function(e){return e.isMyMessage&&0},borderTopLeftRadius:function(e){return!e.isMyMessage&&0},color:function(e){return e.isMyMessage?"black":"white"},background:function(e){return e.isMyMessage?"lightgrey":"linear-gradient(130deg, rgba(39,31,208,1) 0%, rgba(32,167,253,1) 75%, rgba(106,194,255,1) 100%)"}},messageDetails:{display:"flex",justifyContent:function(e){return e.isMyMessage?"end":"space-between"},alignItems:"center"},imageIcon:{width:"15%",borderRadius:e.spacing(2),marginRight:e.spacing(1)},image:{borderRadius:10,display:"block",objectFit:"contain",marginLeft:"auto",marginRight:"auto",outline:"none"}}})),wt=n(120),Et=n(221),Tt=n.n(Et),Nt=function(e){var t,n=e.sender,a=e.createdAt,c=e.textVersions,r=e.isMyMessage,i=A().user,o=Re().isOriginalLanguage,s=Ct(e);return n?Object(w.jsxs)("div",{className:s.root,children:[!r&&Object(w.jsx)(pe,{}),Object(w.jsxs)("div",{className:s.messageContianer,children:[Object(w.jsxs)("div",{className:s.messageDetails,children:[!r&&Object(w.jsxs)(W.a,{variant:"body2",children:[Object(w.jsx)("img",{className:s.imageIcon,alt:n.language,src:"https://unpkg.com/language-icons/icons/".concat(wt.a.getCode(n.language),".svg")}),n.name]}),Object(w.jsx)(W.a,{variant:"caption",children:(t=a,Tt()(t).format("HH:mm"))})]}),Object(w.jsx)("div",{className:s.messageBox,children:Ae({textVersions:c},o,i.language)})]})]}):null},_t=n(473),At=Object(P.a)((function(e){return{root:{width:"100%",padding:10},textField:{width:"100%"}}})),Rt=n(222),kt=n.n(Rt),It=n(223),Dt=n.n(It),Pt=function(e){var t=e.value,n=e.onSelect,c=Object(a.useState)(null),r=Object(h.a)(c,2),i=r[0],o=r[1];return Object(w.jsxs)("div",{children:[Object(w.jsx)(oe.a,{"aria-controls":"customized-menu","aria-haspopup":"true",onClick:function(e){o(e.currentTarget)},children:Object(w.jsx)(Dt.a,{})}),Object(w.jsx)(se.a,{id:"customized-menu",anchorEl:i,open:Boolean(i),onClose:function(){o(null)},children:Object(w.jsx)("div",{children:Object(w.jsx)(kt.a,{onEmojiClick:function(e,a){n("message",t+a.emoji)},groupNames:{smileys_people:"PEOPLE"},native:!0})})})]})},Ut=n(60),Ft=function(){var e=Object(re.a)(ce.a.mark((function e(t,n){var a,c;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=wt.a.getCode(n),console.log(a),e.next=5,x.a.post("".concat("https://translation.googleapis.com/language/translate","/v2?target=").concat(a,"&key=").concat("AIzaSyDL5IjPkVFkAjiFvkFxcIUOw1gAeBdXyLI","&q=").concat(t));case 5:return c=e.sent,e.abrupt("return",c.data.data.translations[0].translatedText);case 9:e.prev=9,e.t0=e.catch(0),console.log(e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),Lt=n(224),Mt=n.n(Lt),Bt=function(){var e=Object(re.a)(ce.a.mark((function e(t,n,a){var c,r,i,o,s;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(c={})[n.language]=a,r=Object(Ut.a)(t),e.prev=3,r.s();case 5:if((i=r.n()).done){e.next=14;break}if(o=i.value,n.language===o.language){e.next=12;break}return e.next=10,Ft(a,o.language);case 10:s=e.sent,c[o.language]=Mt()(s);case 12:e.next=5;break;case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(3),r.e(e.t0);case 19:return e.prev=19,r.f(),e.finish(19);case 22:return e.abrupt("return",c);case 23:case"end":return e.stop()}}),e,null,[[3,16,19,22]])})));return function(t,n,a){return e.apply(this,arguments)}}(),Vt=function(){var e=At(),t=A(),n=t.user,a=t.socket,c=Be(),r={message:"",image:void 0},i=function(){var e=Object(re.a)(ce.a.mark((function e(t,r){var i,o,s,l;return ce.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=t.message,o=t.image,s=r.resetForm,!c._id){e.next=10;break}if(l={textVersions:{}},""===i){e.next=8;break}return e.next=7,Bt(c.users,n,i);case 7:l.textVersions=e.sent;case 8:o&&(l.image=o),De.sendMessage(c._id,l).then((function(e){a.emit("new-message",Object(b.a)(Object(b.a)({},e.data.messageObject),{},{conversationID:c._id})),s()})).catch((function(e){return console.log(e)}));case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(w.jsx)("div",{className:e.root,children:Object(w.jsx)(q.c,{initialValues:r,onSubmit:i,children:function(t){var n=t.values,a=t.setFieldValue;return Object(w.jsx)(q.b,{children:Object(w.jsx)(q.a,{className:e.textField,name:"message",type:"text",placeholder:"Send message...",variant:"outlined",InputProps:{endAdornment:Object(w.jsx)(_t.a,{children:Object(w.jsx)(Pt,{value:n.message,onSelect:a})})},as:z.a})})}})})},Ht=Object(P.a)((function(e){return{root:{maxHeight:"100%",height:"100%",width:"65%"},messagesContainer:{minHeight:"80%",maxHeight:"80%",overflowY:"scroll",scrollbarWidth:"none","&::-webkit-scrollbar":{display:"none"}}}})),Wt=n(485),zt=Object(P.a)((function(e){return Object(D.a)({root:{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",minHeight:"10%",backgroundColor:"#fff",boxShadow:" 0 15px 15px #f5f7fb"},leftRightSideStyle:{display:"flex",justifyContent:"center",alignItems:"center",padding:20},onOfflineStyle:{display:"flex",justifyContent:"space-between",alignItems:"center",width:50},typography:{fontSize:"0.9rem",fontWeight:600,color:"#3A8DFF"}},"@media (max-width:510px)",{root:{flexDirection:"column",justifyContent:"center",padding:10},leftRightSideStyle:{padding:0},typography:{fontSize:"1.3rem"}})})),Gt=(Object(he.a)((function(e){return{badge:{backgroundColor:"#44b700",color:"#44b700",boxShadow:"0 0 0 2px ".concat(e.palette.background.paper),width:e.spacing(1.1),height:e.spacing(1.1),borderRadius:"50%","&::after":{position:"absolute",top:0,left:0,width:"100%",height:"100%",borderRadius:"50%",animation:"$ripple 1.2s infinite ease-in-out",border:"1px solid currentColor",content:'""'}},"@keyframes ripple":{"0%":{transform:"scale(.8)",opacity:1},"100%":{transform:"scale(2.4)",opacity:0}}}}))(ge.a),function(){var e=zt(),t=Re(),n=t.isOriginalLanguage,a=t.toggleOrginalLanguage;return Object(w.jsx)("div",{className:e.root,children:Object(w.jsxs)("div",{className:e.leftRightSideStyle,children:[n?Object(w.jsx)(W.a,{variant:"body2",className:e.typography,children:"Original language"}):Object(w.jsx)(W.a,{variant:"body2",className:e.typography,style:{color:"grey",opacity:.5},children:"Original language"}),Object(w.jsx)(Wt.a,{checked:n,onChange:function(){a(),console.log(n)},color:"primary",name:"checked",inputProps:{"aria-label":"secondary checkbox"}}),Object(w.jsx)(oe.a,{onClick:function(){return console.log("Clicked")},style:{marginLeft:20},children:Object(w.jsx)(de.a,{})})]})})}),qt=function(){var e=A(),t=e.user,n=e.socket,c=Be(),r=c._id,i=c.messages,o=c.users,s=Ve(),l=Ht(),u=Object(a.useRef)(),d=function(e){return o.find((function(t){return t._id===e}))};Object(a.useEffect)((function(){return u.current.scrollIntoView({behavior:"smooth"})}),[i]),Object(a.useEffect)((function(){return n.on("".concat(r,"-message"),(function(e){console.log("Message Pushed",r),s(O(f.PUSH_MESSAGE,e))})),function(){return n.off("".concat(r,"-message"))}}),[r]);return Object(w.jsxs)("div",{className:l.root,children:[Object(w.jsx)(Gt,{}),Object(w.jsxs)("div",{className:l.messagesContainer,children:[i.map((function(e,n){var a=e.sender,c=Object(g.a)(e,["sender"]);return Object(w.jsx)(Nt,Object(b.a)(Object(b.a)({sender:d(a)},c),{},{isMyMessage:a===t._id}),n)})),Object(w.jsx)("div",{ref:u})]}),Object(w.jsx)(Vt,{})]})},Kt=Object(P.a)((function(e){return{root:{display:"flex",padding:0,height:"100vh",overflow:"hidden"},item:{maxHeight:"100%"}}})),Qt=function(){var e=Kt();return Object(w.jsx)(He,{children:Object(w.jsxs)("div",{className:e.root,children:[Object(w.jsx)(St,{}),Object(w.jsx)(qt,{})]})})};n(410).config();var $t=function(){return Object(w.jsxs)(u.a,{theme:l,children:[Object(w.jsx)(d.a,{}),Object(w.jsx)(i.a,{children:Object(w.jsx)(j.a,{maxWidth:"lg",style:{margin:"auto"},children:Object(w.jsxs)(o.d,{children:[Object(w.jsx)(k,{exact:!0,path:"/",component:te}),Object(w.jsx)(R,{path:"/home",component:Qt})]})})})]})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(Object(w.jsx)(_,{children:Object(w.jsx)(Je,{children:Object(w.jsx)(ut,{children:Object(w.jsx)(ke,{children:Object(w.jsx)($t,{})})})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[413,1,2]]]);
//# sourceMappingURL=main.8a5255f7.chunk.js.map